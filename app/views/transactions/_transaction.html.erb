<%= fields_for "transaction[]", transaction do |f| %>
  <%= content_tag_for :tr, transaction, class: cycle("", "alt") do %>
    <td class='posted-at'><%= transaction.posted_at.strftime('%b %d') %></td>
    <td class='payee'><%= f.text_field :payee, title: transaction.original_payee, 'data-saved-value' => transaction.payee %></td>
    <td class='envelope'><%= f.collection_select :envelope_id, all_envelopes, :id, :full_name, {}, 'data-saved-value' => transaction.envelope_id %></td>
    <td class='amount'>
      <% if transaction.associated_transaction_id.nil? %>
        <%= number_to_currency(transaction.amount) %>
      <% else %>
        <%= f.text_field :amount,
          value: number_to_currency(transaction.amount),
          'data-associated-transaction-id' => transaction.associated_transaction_id,
          'data-saved-value' => transaction.amount %>
      <% end %>
    </td>
  <% end %>
<% end %>